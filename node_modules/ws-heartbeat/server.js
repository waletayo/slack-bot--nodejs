"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
function setWsHeartbeat(wss, pong, pingTimeout) {
    if (pingTimeout === void 0) { pingTimeout = 60000; }
    var connections = new Set();
    wss.addListener("connection", function (ws) {
        connections.add(ws);
        ws.addListener("message", function (data, flag) {
            connections.add(ws);
            pong(ws, data, flag ? flag.binary : false);
        });
    });
    setInterval(function () {
        for (var _i = 0, _a = wss.clients; _i < _a.length; _i++) {
            var ws = _a[_i];
            if (ws.readyState === ws.CONNECTING || ws.readyState === ws.OPEN) {
                if (!connections.has(ws)) {
                    ws.close();
                }
            }
        }
        connections.clear();
    }, pingTimeout);
}
exports.setWsHeartbeat = setWsHeartbeat;
